# 使用 SOPS 加密后提交。以下值为第一个 demo 站点的默认配置。
image:
  web:
    repository: ghcr.io/ellistondow/kubemage-web
    tag: demo-0.1.3
  php:
    repository: ghcr.io/ellistondow/kubemage-php
    tag: demo-0.1.3
  cron:
    repository: ghcr.io/ellistondow/kubemage-cron
    tag: demo-0.1.3

env:
  baseUrl: https://magento.k8s.bdgyoo.com
  mysqlHost: percona.databases.svc.cluster.local
  rabbitmqHost: rabbitmq.messaging.svc.cluster.local
  redisHost: valkey.cache.svc.cluster.local
  mediaBucket: s3://demo-media
  openSearchHost: opensearch.search.svc.cluster.local
  openSearchPort: 9200

remoteStorage:
  driver: aws-s3
  bucket: demo-media
  region: us-east-1
  prefix: media
  endpoint: http://minio.object-storage.svc.cluster.local:9000
  usePathStyle: true

storage:
  generated:
    enabled: true
    size: 2Gi
    accessMode: ReadWriteOnce
  varDi:
    enabled: true
    size: 2Gi
    accessMode: ReadWriteOnce
  pubStatic:
    enabled: true
    size: 4Gi
    accessMode: ReadWriteOnce

varnish:
  enabled: true
  configSecret: ""
  serviceName: varnish
  servicePort: 6081
  purgeCIDRs:
    - 10.0.0.0/8

consumers:
  enabled: true
  list:
    - name: async-bulk
      queue: async.operations.all
      maxMessages: 1000
    - name: product-attr-update
      queue: product_action_attribute.update
      maxMessages: 500
    - name: product-attr-website
      queue: product_action_attribute.website.update
      maxMessages: 500
    - name: catalog-website-attr-sync
      queue: catalog_website_attribute_value_sync
      maxMessages: 500
    - name: export-processor
      queue: exportProcessor
      maxMessages: 200
    - name: inventory-mass-update
      queue: inventory.mass.update
      maxMessages: 500
    - name: inventory-source-items-cleanup
      queue: inventory.source.items.cleanup
      maxMessages: 200
    - name: inventory-reservations-update
      queue: inventory.reservations.update
      maxMessages: 500
    - name: inventory-reservations-cleanup
      queue: inventory.reservations.cleanup
      maxMessages: 200
    - name: inventory-reservations-update-salability
      queue: inventory.reservations.updateSalabilityStatus
      maxMessages: 200
    - name: inventory-indexer-source
      queue: inventory.indexer.sourceItem
      maxMessages: 500
    - name: inventory-indexer-stock
      queue: inventory.indexer.stock
      maxMessages: 500
    - name: media-image-resize
      queue: media.storage.catalog.image.resize
      maxMessages: 200
    - name: media-content-sync
      queue: media.content.synchronization
      maxMessages: 200
    - name: media-gallery-sync
      queue: media.gallery.synchronization
      maxMessages: 200
    - name: media-gallery-renditions
      queue: media.gallery.renditions.update
      maxMessages: 200
    - name: sales-rule-quote
      queue: sales.rule.quote.trigger.recollect
      maxMessages: 200
    - name: sales-rule-coupon
      queue: sales.rule.update.coupon.usage
      maxMessages: 200
    - name: product-alert
      queue: product_alert
      maxMessages: 200
    - name: save-config
      queue: saveConfigProcessor
      maxMessages: 200
    - name: codegenerator
      queue: codegeneratorProcessor
      maxMessages: 200

ingress:
  enabled: true
  className: nginx
  annotations:
    nginx.ingress.kubernetes.io/proxy-buffer-size: 512k
    nginx.ingress.kubernetes.io/proxy-buffers-number: "32"
  hosts:
    - host: magento.k8s.bdgyoo.com
      paths:
        - path: /
          pathType: Prefix
  tls:
    - secretName: magento-k8s-bdgyoo-com-tls
      hosts:
        - magento.k8s.bdgyoo.com

redis:
  databases:
    cache: 8
    fpc: 9
    session: 10
    page_cache: 11

secrets:
  create: true
  name: demo-magento-secrets
  mysqlUser: ENC[AES256_GCM,data:+d5/Wqxz8Q==,iv:3zjHU3s5bT+DjU5K5MOD5iFPKuHh1RIdLjBNHaAiAwg=,tag:pTOaAt3BNNdMyaTPzQjxTw==,type:str]
  mysqlPassword: ENC[AES256_GCM,data:A4J6hnh9j7UTAKPT,iv:yO2BkyNa7ppBZqSYZeuaYsHRjLqq2BanDWbo9JZm2CU=,tag:U2NvastI54SB6rIOTPJrKg==,type:str]
  mysqlRoot: ENC[AES256_GCM,data:A8HmVCrtZswy3O/xWEOwyQ==,iv:Z0/L+i87Fq56tmvEQW2GGeyaIK05Tk9E3xYNoQBSvlA=,tag:v/Idw1EbChq9Z4GsFsbWkQ==,type:str]
  rabbitmqPassword: ENC[AES256_GCM,data:SUCtU8/jDQz/Xdg=,iv:frL9P+53W5KkQJgoAvo2tldw+3luUA4l9xcQBBupd04=,tag:mlGaRQrb/GkjoI393TciMQ==,type:str]
  redisPassword: ENC[AES256_GCM,data:0etCaCW7OgUhh8qI+Q==,iv:Z3InGG2ZwH1KSYyUckEHIXgFd0fVU5I8TbskIyKV12M=,tag:6mC2z3rR7NBCQcvro9EGHw==,type:str]
  remoteStorageAccessKey: ENC[AES256_GCM,data:1sg96LsgZc0BszbLjA==,iv:GefuU8Q410Z3N7tbGjc0IZOJfD3emSN4iggHF6Mq438=,tag:rFgMMlRpYJaTpPwUg+oxlA==,type:str]
  remoteStorageSecretKey: ENC[AES256_GCM,data:A+AjBTbcNluxa0jNwuPgqM/f/pc=,iv:Y7fuQ6sbl4F4km3faogfoHyPZPS+w36r5VScwTyvGCU=,tag:B2BI07C39P5CRVI802qWnA==,type:str]
