image:
  web:
    repository: registry.example.com/kubemage/magento-web
    tag: latest
  php:
    repository: registry.example.com/kubemage/magento-php-fpm
    tag: latest
  cron:
    repository: registry.example.com/kubemage/magento-cron
    tag: latest
  varnish:
    repository: docker.io/library/varnish
    tag: 7.6
  pullPolicy: IfNotPresent

replicaCount:
  web: 2
  php: 2
  varnish: 2

web:
  pagespeed:
    enabled: true

service:
  type: ClusterIP
  port: 8080

varnish:
  enabled: true
  replicaCount: 2
  serviceName: varnish
  servicePort: 6081
  backendPort: 8080
  storage: "512m"
  extraEnv: {}
  configSecret: ""
  purgeCIDRs:
    - 10.0.0.0/8

resources:
  web:
    requests:
      cpu: 500m
      memory: 1Gi
    limits:
      cpu: 2000m
      memory: 2Gi
  php:
    requests:
      cpu: 1
      memory: 2Gi
    limits:
      cpu: 4
      memory: 4Gi
  cron:
    requests:
      cpu: 200m
      memory: 512Mi
  varnish:
    requests:
      cpu: 500m
      memory: 512Mi
    limits:
      cpu: 2000m
      memory: 2Gi

env:
  baseUrl: https://store.example.com
  mediaBucket: s3://store-media
  rabbitmqHost: magento-mq.messaging.svc
  redisHost: valkey.cache.svc
  mysqlHost: magento-db-pxc.databases.svc

remoteStorage:
  driver: file
  bucket: ""
  region: ""
  prefix: media
  endpoint: http://minio.object-storage.svc.cluster.local:9000
  usePathStyle: true

cron:
  schedules:
    - name: main
      schedule: "* * * * *"
      command: ["/bin/bash", "-c", "php bin/magento cron:run"]

consumers:
  enabled: true
  resources:
    requests:
      cpu: 250m
      memory: 512Mi
    limits:
      cpu: 1
      memory: 1Gi
  list:
    - name: async-bulk
      queue: async.operations.all
    - name: product-attr-update
      queue: product_action_attribute.update
      maxMessages: 500
    - name: product-attr-website
      queue: product_action_attribute.website.update
      maxMessages: 500
    - name: catalog-website-attr-sync
      queue: catalog_website_attribute_value_sync
      maxMessages: 500
    - name: export-processor
      queue: exportProcessor
      maxMessages: 200
    - name: inventory-mass-update
      queue: inventory.mass.update
      maxMessages: 500
    - name: inventory-source-items-cleanup
      queue: inventory.source.items.cleanup
      maxMessages: 200
    - name: inventory-reservations-update
      queue: inventory.reservations.update
      maxMessages: 500
    - name: inventory-reservations-cleanup
      queue: inventory.reservations.cleanup
      maxMessages: 200
    - name: inventory-reservations-update-salability
      queue: inventory.reservations.updateSalabilityStatus
      maxMessages: 200
    - name: inventory-indexer-source
      queue: inventory.indexer.sourceItem
      maxMessages: 500
    - name: inventory-indexer-stock
      queue: inventory.indexer.stock
      maxMessages: 500
    - name: media-image-resize
      queue: media.storage.catalog.image.resize
      maxMessages: 200
    - name: media-content-sync
      queue: media.content.synchronization
      maxMessages: 200
    - name: media-gallery-sync
      queue: media.gallery.synchronization
      maxMessages: 200
    - name: media-gallery-renditions
      queue: media.gallery.renditions.update
      maxMessages: 200
    - name: sales-rule-quote
      queue: sales.rule.quote.trigger.recollect
      maxMessages: 200
    - name: sales-rule-coupon
      queue: sales.rule.update.coupon.usage
      maxMessages: 200
    - name: product-alert
      queue: product_alert
      maxMessages: 200
    - name: save-config
      queue: saveConfigProcessor
      maxMessages: 200
    - name: codegenerator
      queue: codegeneratorProcessor
      maxMessages: 200

hpa:
  web:
    enabled: true
    minReplicas: 2
    maxReplicas: 8
    cpu: 60
  php:
    enabled: true
    minReplicas: 2
    maxReplicas: 12
    cpu: 70
keda:
  rabbitmq:
    enabled: true
    queueName: async.operations.all
    scalingStrategy: cpu

ingress:
  enabled: true
  className: nginx
  annotations: {}
  hosts:
    - host: store.example.com
      paths:
      - path: /
        pathType: Prefix
  tls:
    - secretName: store-tls
      hosts:
        - store.example.com

storage:
  generated:
    enabled: true
    size: 2Gi
    accessMode: ReadWriteOnce
  varDi:
    enabled: true
    size: 2Gi
    accessMode: ReadWriteOnce
  pubStatic:
    enabled: true
    size: 4Gi
    accessMode: ReadWriteOnce

secrets:
  create: true
  name: ""
  mysqlUser: magento
  mysqlPassword: changeme
  mysqlRoot: changeme-root
  rabbitmqPassword: changeme-rmq
  redisPassword: changeme-redis
  remoteStorageAccessKey: ""
  remoteStorageSecretKey: ""
